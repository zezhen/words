<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Interesting Scala | Zezhen</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script><!-- hexo-inject:begin --><!-- hexo-inject:end -->(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-75244464-1','auto');ga('send','pageview');
</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Interesting Scala</h1><a id="logo" href="/.">Zezhen</a><p class="description">Be different and Make a difference</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-4-4"><div class="content_container"><div class="post"><h1 class="post-title">Interesting Scala</h1><div class="post-meta">Jul 2, 2018<span> | </span><span class="category"><a href="/categories/tech/">tech</a><a href="/categories/english/">english</a></span></div><a class="disqus-comment-count" data-disqus-identifier="posts/interesting-scala/" href="/posts/interesting-scala/#disqus_thread"></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">Functions vs Methods</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">2.</span> <span class="toc-text">Variance and Type Bounds</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.1.</span> <span class="toc-text">Covariance and Upper Bounds</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.2.</span> <span class="toc-text">Contravariance and Lower Bounds</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.3.</span> <span class="toc-text">Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text">Implicit X</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.1.</span> <span class="toc-text">Implicit Parameter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.2.</span> <span class="toc-text">Implicit Conversion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.3.</span> <span class="toc-text">Implicit Class</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">4.</span> <span class="toc-text">Sugars</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.1.</span> <span class="toc-text">Extractor Objects</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.2.</span> <span class="toc-text">By-Name Parameters</span></a></li></ol></li></ol></div></div><div class="post-content"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p><img src="/img/scala-spiral.png" alt=""></p>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><p>各种编程语言中, 对于Java是最为熟悉的, 但用久了就觉得各种不方便, 比如函数不是第一公民, 在其他程序中很方便的实现在Java里得用各种类封装, 相比之下, 用脚本语言就特别开心, 比如Python, 很是提高生产力, 可惜仅用来做做些文本处理以及搭建小的web app, 并不适用大型程序. 而scala的出现则弥补了两方面的问题, 既有静态程序的编译安全, 又有动态脚本的方便灵活, 号称better Java, 或者freestyle Java. 最近略感有空, 学习一下, 记录下有趣的feature.</p>
<h2><span id="functions-vs-methods">Functions vs Methods</span></h2><p>A Scala <em>method</em>, as in Java, is a part of a class. It has a name, a signature, optionally some annotations, and some bytecode. </p>
<p>A <em>function</em> in Scala is a complete object. There are a series of traits in Scala to represent functions with various numbers of arguments: Function0, Function1, Function2, etc. As an instance of a class that implements one of these traits, a function object has methods. One of these methods is the apply method, which contains the code that implements the body of the function. </p>
<p>When we treat a method as a function, such as by assigning it to a variable, Scala actually creates a function object whose apply method calls the original method, and that is the object that gets assigned to the variable. Defining a function object and assigning it to an instance variable this way consumes more memory than just defining the functionally equivalent method because of the additional instance variable and the overhead of another object instance for the function. Thus you would not want every method to be a function; but functions give you a great deal of power that is not available with just methods, and in those situations that power is well worth the additional memory used. </p>
<p>Note the difference in the signatures between method <em>addThenMultiply</em> and function <em>func</em>, underscore <em>_</em> tells Scala to treat func as a function rather than taking the value generated by a call to that method.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">scala&gt;</span> def addThenMultiply(x: Int, y: Int)(multiplier: Int): Int = (x + y) * multiplier</span><br><span class="line">addThenMultiply: (x: Int, y: Int)(multiplier: Int)Int</span><br><span class="line"></span><br><span class="line"><span class="meta">scala&gt;</span> val func = addThenMultiply(1, 2) _</span><br><span class="line">func: Int =&gt; Int = &lt;function1&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">scala&gt;</span> func(3)</span><br><span class="line">res0: Int = 9</span><br></pre></td></tr></table></figure>
<p>detail refer to <a href="http://jim-mcbeath.blogspot.com/2009/05/scala-functions-vs-methods.html" target="_blank" rel="noopener">Scala Functions vs Methods</a></p>
<h2><span id="variance-and-type-bounds">Variance and Type Bounds</span></h2><p>Generic classes take a type as a parameter within square brackets <code>[]</code>. <code>Variance</code> is the correlation of subtyping relationships of complex types and the subtyping relationships of their component types. </p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Baz</span>[<span class="type">A</span>]  <span class="title">//</span> <span class="title">An</span> <span class="title">invariant</span> <span class="title">class</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">Foo</span>[+<span class="type">A</span>] <span class="title">//</span> <span class="title">A</span> <span class="title">covariant</span> <span class="title">class</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">Bar</span>[-<span class="type">A</span>] <span class="title">//</span> <span class="title">A</span> <span class="title">contravariant</span> <span class="title">class</span></span></span><br></pre></td></tr></table></figure>
<h3><span id="covariance-and-upper-bounds">Covariance and Upper Bounds</span></h3><p>class <code>List[+A]</code>, means that List can take any class, if B is a <em>subtype</em> of A, then <code>List[B]</code> is considered to be a <em>subtype</em> of <code>List[A]</code>. This mainly works in container, subtypes’ container is another container of supertype’s.</p>
<p>Accordingly, from type bounds perspective, the upper type bounds <code>List[B &lt;: A]</code>, it limits a type to a subtype, List will only take class B that is a subclass of A, which is similar to <code>? extends A</code> in Java.</p>
<h3><span id="contravariance-and-lower-bounds">Contravariance and Lower Bounds</span></h3><p>class <code>Writer[-A]</code>, means that Writer can take any class, if B is <em>supertype</em> of A, <code>Writer[B]</code> is a <em>subtype</em> of <code>Writer[A]</code>. This mainly works in functionality perspective, if subtype class has some functions, the supertype class should also have.</p>
<p>Accordingly, from type bounds perspective, it’s lower type boundd <code>Writer[B &gt;: A]</code>, which declares a type to be a supertype of another type, similar to <code>? super T</code> in Java.</p>
<h3><span id="example">Example</span></h3><p>Below example shows the <code>trait Node[+A]</code> defined as covariance, which means any of subtype <code>B</code>, the <code>Node[B]</code> is subtype of <code>Node[A]</code>, thus we need to guarantee that in the function <code>prepend</code>, all elem prepended should be type A or its supertype, thus we have to use lower bounds type, otherwize error <code>covariant type A occurs in contravariant position in type A of value elem</code> will raise.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Node</span>[+<span class="type">A</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">prepend</span></span>[<span class="type">U</span> &gt;: <span class="type">A</span>](elem: <span class="type">U</span>): <span class="type">Node</span>[<span class="type">U</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span>[+<span class="type">A</span>](<span class="params">h: <span class="type">A</span>, t: <span class="type">Node</span>[<span class="type">A</span>]</span>) <span class="keyword">extends</span> <span class="title">Node</span>[<span class="type">A</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">prepend</span></span>[<span class="type">U</span> &gt;: <span class="type">A</span>](elem: <span class="type">U</span>): <span class="type">ListNode</span>[<span class="type">U</span>] = <span class="type">ListNode</span>(elem, <span class="keyword">this</span>)</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">head</span></span>: <span class="type">A</span> = h</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">tail</span></span>: <span class="type">Node</span>[<span class="type">A</span>] = t</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Nil</span>[+<span class="type">A</span>](<span class="params"></span>) <span class="keyword">extends</span> <span class="title">Node</span>[<span class="type">A</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">prepend</span></span>[<span class="type">U</span> &gt;: <span class="type">A</span>](elem: <span class="type">U</span>): <span class="type">ListNode</span>[<span class="type">U</span>] = <span class="type">ListNode</span>(elem, <span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2><span id="implicit-x">Implicit X</span></h2><h3><span id="implicit-parameter">Implicit Parameter</span></h3><p>Scala will look if it can get an implicit value of the correct type, and if it can, pass it automatically.</p>
<ol>
<li>Scala will first look for implicit definitions and implicit parameters that can be accessed directly (without a prefix) at the point the method with the implicit parameter block is called.</li>
<li>Then it looks for members marked implicit in all the companion objects associated with the implicit candidate type.</li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Monoid</span>[<span class="type">A</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(x: <span class="type">A</span>, y: <span class="type">A</span>): <span class="type">A</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">unit</span></span>: <span class="type">A</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">ImplicitTest</span> </span>&#123;</span><br><span class="line">  <span class="keyword">implicit</span> <span class="keyword">val</span> stringMonoid: <span class="type">Monoid</span>[<span class="type">String</span>] = <span class="keyword">new</span> <span class="type">Monoid</span>[<span class="type">String</span>] &#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(x: <span class="type">String</span>, y: <span class="type">String</span>): <span class="type">String</span> = x concat y</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unit</span></span>: <span class="type">String</span> = <span class="string">""</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">implicit</span> <span class="keyword">val</span> intMonoid: <span class="type">Monoid</span>[<span class="type">Int</span>] = <span class="keyword">new</span> <span class="type">Monoid</span>[<span class="type">Int</span>] &#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(x: <span class="type">Int</span>, y: <span class="type">Int</span>): <span class="type">Int</span> = x + y</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unit</span></span>: <span class="type">Int</span> = <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">sum</span></span>[<span class="type">A</span>](xs: <span class="type">List</span>[<span class="type">A</span>])(<span class="keyword">implicit</span> m: <span class="type">Monoid</span>[<span class="type">A</span>]): <span class="type">A</span> =</span><br><span class="line">    <span class="keyword">if</span> (xs.isEmpty) m.unit</span><br><span class="line">    <span class="keyword">else</span> m.add(xs.head, sum(xs.tail))</span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    println(sum(<span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)))       <span class="comment">// uses IntMonoid implicitly</span></span><br><span class="line">    println(sum(<span class="type">List</span>(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>))) <span class="comment">// uses StringMonoid implicitly</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="implicit-conversion">Implicit Conversion</span></h3><p>The concept is very similar to design pattern <code>adaptor</code>, which convert a type <code>S</code> to <code>T</code>, see below examples.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scala.language.implicitConversions</span><br><span class="line"></span><br><span class="line"><span class="keyword">implicit</span> <span class="function"><span class="keyword">def</span> <span class="title">list2ordered</span></span>[<span class="type">A</span>](x: <span class="type">List</span>[<span class="type">A</span>])</span><br><span class="line">    (<span class="keyword">implicit</span> elem2ordered: <span class="type">A</span> =&gt; <span class="type">Ordered</span>[<span class="type">A</span>]): <span class="type">Ordered</span>[<span class="type">List</span>[<span class="type">A</span>]] =</span><br><span class="line">  <span class="keyword">new</span> <span class="type">Ordered</span>[<span class="type">List</span>[<span class="type">A</span>]] &#123; </span><br><span class="line">    <span class="comment">//replace with a more useful implementation</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">compare</span></span>(that: <span class="type">List</span>[<span class="type">A</span>]): <span class="type">Int</span> = <span class="number">1</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3><span id="implicit-class">Implicit Class</span></h3><p>Below example creates the implicit class IntWithTimes. This class wraps an Int value and provides a new method, times. To use this class, just import it into scope and call the times method.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">object Helpers &#123;							// must be defined inside of another trait/class/object</span><br><span class="line">  implicit class IntWithTimes(x: Int) &#123;		// only take one non-implicit argument</span><br><span class="line">    def times[A](f: =&gt; A): Unit = &#123;</span><br><span class="line">      def loop(current: Int): Unit =</span><br><span class="line">        if(current &gt; 0) &#123;</span><br><span class="line">          f</span><br><span class="line">          loop(current - 1)</span><br><span class="line">        &#125;</span><br><span class="line">      loop(x)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">scala&gt;</span> import Helpers._</span><br><span class="line">import Helpers._</span><br><span class="line"></span><br><span class="line"><span class="meta">scala&gt;</span> 3 times println("HI")</span><br><span class="line">HI</span><br><span class="line">HI</span><br><span class="line">HI</span><br></pre></td></tr></table></figure>
<h2><span id="sugars">Sugars</span></h2><h3><span id="extractor-objects">Extractor Objects</span></h3><p>An extractor object is an object with an unapply method. Whereas the apply method is like a constructor which takes arguments and creates an object, the unapply takes an object and tries to give back the arguments. </p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scala.util.<span class="type">Random</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">CustomerID</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(name: <span class="type">String</span>) = <span class="string">s"<span class="subst">$name</span>--<span class="subst">$&#123;Random.nextLong&#125;</span>"</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">unapply</span></span>(customerID: <span class="type">String</span>): <span class="type">Option</span>[<span class="type">String</span>] = &#123;</span><br><span class="line">    <span class="keyword">val</span> stringArray: <span class="type">Array</span>[<span class="type">String</span>] = customerID.split(<span class="string">"--"</span>)</span><br><span class="line">    <span class="keyword">if</span> (stringArray.tail.nonEmpty) <span class="type">Some</span>(stringArray.head) <span class="keyword">else</span> <span class="type">None</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> customer1ID = <span class="type">CustomerID</span>(<span class="string">"Sukyoung"</span>)  <span class="comment">// Sukyoung--23098234908</span></span><br><span class="line">customer1ID <span class="keyword">match</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="type">CustomerID</span>(name) =&gt; println(name)  <span class="comment">// prints Sukyoung</span></span><br><span class="line">  <span class="keyword">case</span> _ =&gt; println(<span class="string">"Could not extract a CustomerID"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3><span id="by-name-parameters">By-Name Parameters</span></h3><p>By-name parameters are only evaluated when used.</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate1</span></span>(flag: <span class="type">Boolean</span>, expr: =&gt; <span class="type">Int</span>) : <span class="type">Int</span> = &#123;</span><br><span class="line">  <span class="keyword">if</span>(flag) expr * <span class="number">37</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate2</span></span>(flag: <span class="type">Boolean</span>, expr: <span class="type">Int</span>) : <span class="type">Int</span> = &#123;</span><br><span class="line">  <span class="keyword">if</span>(flag) expr * <span class="number">37</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">expr</span></span>() : <span class="type">Int</span> = &#123;</span><br><span class="line">  println(<span class="string">"execute method expr"</span>)</span><br><span class="line">  <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">println(calculate1(<span class="literal">false</span>, expr()))	<span class="comment">// 0</span></span><br><span class="line">println(calculate2(<span class="literal">false</span>, expr()))	<span class="comment">// execute method expr 0</span></span><br></pre></td></tr></table></figure>
</div><div class="tags"><a href="/tags/coding/">coding</a></div><div class="post-nav"><a class="pre" href="/posts/play-scratch-dev-part/">把玩Scratch - 开发篇</a><a class="next" href="/posts/life-ascending/">生命的跃升</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://zezhen.me/posts/interesting-scala/';
    this.page.identifier = 'posts/interesting-scala/';
    this.page.title = 'Interesting Scala';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//zezhen.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//zezhen.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://zezhen.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1 pure-u-md-4-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">Zezhen.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end --></body></html>